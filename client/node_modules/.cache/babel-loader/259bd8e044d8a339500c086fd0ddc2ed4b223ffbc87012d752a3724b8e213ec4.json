{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Kurtj/Desktop/Uni Work/stevewebsitereact/try/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Kurtj/Desktop/Uni Work/stevewebsitereact/try/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Kurtj/Desktop/Uni Work/stevewebsitereact/try/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from\"react\";import\"./write.css\";import axios from\"axios\";import{Context}from'./../../context/Context';import{useContext}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=15;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);newPost.photo=filename;_context.prev=8;_context.next=11;return axios.post(\"/upload\",data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return axios.post(\"/posts\",newPost);case 18:res=_context.sent;window.location.replace(\"/post/\"+res.data._id);_context.next=24;break;case 22:_context.prev=22;_context.t1=_context[\"catch\"](15);case 24:case\"end\":return _context.stop();}},_callee,null,[[8,13],[15,22]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{className:\"writeImg\",src:URL.createObjectURL(file),alt:\"\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"writeIcon fa-sharp fa-solid fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"writeInput writeText\",onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"names":["useState","axios","Context","useContext","Write","title","setTitle","desc","setDesc","file","setFile","user","handleSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","name","append","photo","post","res","window","location","replace","_id","URL","createObjectURL","display","target","files","value"],"sources":["C:/Users/Kurtj/Desktop/Uni Work/stevewebsitereact/try/client/src/pages/write/Write.jsx"],"sourcesContent":["import { useState } from \"react\"\r\nimport \"./write.css\"\r\nimport axios from \"axios\"\r\nimport { Context } from './../../context/Context';\r\nimport { useContext } from \"react\";\r\n\r\nexport default function Write() {\r\n  const [title, setTitle] = useState(\"\")\r\n  const [desc, setDesc] = useState(\"\")\r\n  const [file, setFile] = useState(null)\r\n  const { user } = useContext(Context)\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const newPost = {\r\n      username: user.username,\r\n      title,\r\n      desc,\r\n    };\r\n    if (file) {\r\n      const data = new FormData();\r\n      const filename = Date.now() + file.name;\r\n      data.append(\"name\", filename);\r\n      data.append(\"file\", file);\r\n      newPost.photo = filename;\r\n      try {\r\n        await axios.post(\"/upload\", data);\r\n      } catch (err) {\r\n\r\n      }\r\n    }\r\n    try {\r\n      const res = await axios.post(\"/posts\", newPost);\r\n      window.location.replace(\"/post/\" + res.data._id);\r\n    } catch (err) {\r\n\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"write\">\r\n      {file && <img className=\"writeImg\" src={URL.createObjectURL(file)} alt=\"\" />\r\n      }\r\n        <form className=\"writeForm\" onSubmit={handleSubmit}>\r\n            <div className=\"writeFormGroup\">\r\n                <label htmlFor=\"fileInput\">\r\n                <i className=\"writeIcon fa-sharp fa-solid fa-plus\"></i>\r\n                </label>\r\n                <input type=\"file\" id=\"fileInput\" style={{display: \"none\"}} onChange={e=> setFile(e.target.files[0])}/>\r\n                <input type=\"text\" placeholder=\"Title\" className=\"writeInput\" autoFocus={true} onChange={e=>setTitle(e.target.value)}/>\r\n            </div>\r\n            <div className=\"writeFormGroup\">\r\n                <textarea placeholder=\"Tell your story...\" type=\"text\" className=\"writeInput writeText\" onChange={e=>setDesc(e.target.value)}></textarea>\r\n            </div>\r\n            <button className=\"writeSubmit\" type=\"submit\">Publish</button>\r\n        </form>\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"scAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,MAAO,aAAa,CACpB,MAAOC,MAAK,KAAM,OAAO,CACzB,OAASC,OAAO,KAAQ,yBAAyB,CACjD,OAASC,UAAU,KAAQ,OAAO,CAAC,wFAEnC,cAAe,SAASC,MAAK,EAAG,CAC9B,cAA0BJ,QAAQ,CAAC,EAAE,CAAC,wCAA/BK,KAAK,eAAEC,QAAQ,eACtB,eAAwBN,QAAQ,CAAC,EAAE,CAAC,yCAA7BO,IAAI,eAAEC,OAAO,eACpB,eAAwBR,QAAQ,CAAC,IAAI,CAAC,yCAA/BS,IAAI,eAAEC,OAAO,eACpB,gBAAiBP,UAAU,CAACD,OAAO,CAAC,CAA5BS,IAAI,aAAJA,IAAI,CAEZ,GAAMC,aAAY,4FAAG,iBAAOC,CAAC,iJAC3BA,CAAC,CAACC,cAAc,EAAE,CACZC,OAAO,CAAG,CACdC,QAAQ,CAAEL,IAAI,CAACK,QAAQ,CACvBX,KAAK,CAALA,KAAK,CACLE,IAAI,CAAJA,IACF,CAAC,KACGE,IAAI,0BACAQ,IAAI,CAAG,GAAIC,SAAQ,EAAE,CACrBC,QAAQ,CAAGC,IAAI,CAACC,GAAG,EAAE,CAAGZ,IAAI,CAACa,IAAI,CACvCL,IAAI,CAACM,MAAM,CAAC,MAAM,CAAEJ,QAAQ,CAAC,CAC7BF,IAAI,CAACM,MAAM,CAAC,MAAM,CAAEd,IAAI,CAAC,CACzBM,OAAO,CAACS,KAAK,CAAGL,QAAQ,CAAC,uCAEjBlB,MAAK,CAACwB,IAAI,CAAC,SAAS,CAAER,IAAI,CAAC,0IAMjBhB,MAAK,CAACwB,IAAI,CAAC,QAAQ,CAAEV,OAAO,CAAC,SAAzCW,GAAG,eACTC,MAAM,CAACC,QAAQ,CAACC,OAAO,CAAC,QAAQ,CAAGH,GAAG,CAACT,IAAI,CAACa,GAAG,CAAC,CAAC,8JAIpD,kBAzBKlB,aAAY,4CAyBjB,CACD,mBACE,aAAK,SAAS,CAAC,OAAO,WACnBH,IAAI,eAAI,YAAK,SAAS,CAAC,UAAU,CAAC,GAAG,CAAEsB,GAAG,CAACC,eAAe,CAACvB,IAAI,CAAE,CAAC,GAAG,CAAC,EAAE,EAAG,cAE1E,cAAM,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAEG,YAAa,wBAC/C,aAAK,SAAS,CAAC,gBAAgB,wBAC3B,cAAO,OAAO,CAAC,WAAW,uBAC1B,UAAG,SAAS,CAAC,qCAAqC,EAAK,EAC/C,cACR,cAAO,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,WAAW,CAAC,KAAK,CAAE,CAACqB,OAAO,CAAE,MAAM,CAAE,CAAC,QAAQ,CAAE,kBAAApB,CAAC,QAAGH,QAAO,CAACG,CAAC,CAACqB,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAC,EAAE,cACvG,cAAO,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,SAAS,CAAC,YAAY,CAAC,SAAS,CAAE,IAAK,CAAC,QAAQ,CAAE,kBAAAtB,CAAC,QAAEP,SAAQ,CAACO,CAAC,CAACqB,MAAM,CAACE,KAAK,CAAC,EAAC,EAAE,GACrH,cACN,YAAK,SAAS,CAAC,gBAAgB,uBAC3B,iBAAU,WAAW,CAAC,oBAAoB,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,sBAAsB,CAAC,QAAQ,CAAE,kBAAAvB,CAAC,QAAEL,QAAO,CAACK,CAAC,CAACqB,MAAM,CAACE,KAAK,CAAC,EAAC,EAAY,EACvI,cACN,eAAQ,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,UAAC,SAAO,EAAS,GAC3D,GACL,CAEV"},"metadata":{},"sourceType":"module","externalDependencies":[]}