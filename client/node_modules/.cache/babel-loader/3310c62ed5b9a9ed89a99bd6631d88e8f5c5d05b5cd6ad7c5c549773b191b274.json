{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Kurtj/Desktop/Uni Work/stevewebsitereact/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Kurtj/Desktop/Uni Work/stevewebsitereact/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Kurtj/Desktop/Uni Work/stevewebsitereact/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./singlePost.css\";import axios from\"axios\";import{useLocation}from\"react-router-dom\";import Sidebar from\"../../components/sidebar/Sidebar\";import{useEffect,useState,useContext}from\"react\";import{Context}from\"../../context/Context\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SinglePost(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var PF=\"http://localhost:5000/images/\";var _useContext=useContext(Context),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateMode=_useState8[0],setUpdateMode=_useState8[1];useEffect(function(){var getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/posts/\"+path);case 2:res=_context.sent;setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);case 6:case\"end\":return _context.stop();}},_callee);}));return function getPost(){return _ref.apply(this,arguments);};}();getPost();},[path]);var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/posts/\".concat(post._id),{data:{username:user.username}});case 3:window.location.replace(\"/\");_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.put(\"/posts/\".concat(post._id),{username:user.username,title:title,desc:desc});case 3://IF WANT TO RELOAD PAGE\n// window.location.reload();\nsetUpdateMode(false);_context3.next=8;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);case 8:case\"end\":return _context3.stop();}},_callee3,null,[[0,6]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"singlePost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{src:PF+post.photo,alt:\"\",className:\"singlePostImg\"}),updateMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,className:\"singlePostTitleInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singlePostTitle\",children:[title,post.username===(user===null||user===void 0?void 0:user.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon fa-regular fa-pen-to-square\",onClick:function onClick(){return setUpdateMode(true);}}),/*#__PURE__*/_jsx(\"i\",{class:\"singlePostIcon fa-solid fa-trash\",onClick:handleDelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlePostAuthor\",children:[\"Author:\",/*#__PURE__*/_jsx(Link,{to:\"/?user=\".concat(post.username),className:\"link\",children:/*#__PURE__*/_jsx(\"b\",{children:post.username})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlePostDate\",children:new Date(post.createdAt).toDateString()})]}),updateMode?/*#__PURE__*/_jsx(\"textarea\",{className:\"singlePostDescInput\",value:desc,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/_jsx(\"p\",{className:\"singlePostDesc\",children:desc}),updateMode&&/*#__PURE__*/_jsx(\"button\",{className:\"singlePostButton\",onClick:handleUpdate,children:\"Update\"})]})});}","map":{"version":3,"names":["axios","useLocation","Sidebar","useEffect","useState","useContext","Context","Link","SinglePost","location","path","pathname","split","post","setPost","PF","user","title","setTitle","desc","setDesc","updateMode","setUpdateMode","getPost","get","res","data","handleDelete","delete","_id","username","window","replace","handleUpdate","put","photo","e","target","value","Date","createdAt","toDateString"],"sources":["C:/Users/Kurtj/Desktop/Uni Work/stevewebsitereact/client/src/components/singlePost/SinglePost.jsx"],"sourcesContent":["import \"./singlePost.css\"\r\nimport axios from \"axios\";\r\nimport { useLocation } from \"react-router-dom\"\r\nimport Sidebar from \"../../components/sidebar/Sidebar\"\r\nimport { useEffect, useState, useContext } from \"react\"\r\nimport { Context } from \"../../context/Context\";\r\nimport {Link} from \"react-router-dom\"\r\n\r\nexport default function SinglePost() {\r\n  const location = useLocation()\r\n  const path = location.pathname.split(\"/\")[2];\r\n  const [post, setPost] = useState({})\r\n  const PF = \"http://localhost:5000/images/\";\r\n  const { user } = useContext(Context);\r\n  const [title, setTitle] = useState(\"\")\r\n  const [desc, setDesc] = useState(\"\")\r\n  const [updateMode, setUpdateMode] = useState(false)\r\n\r\n  useEffect(() => {\r\n    const getPost = async () => {\r\n      const res = await axios.get(\"/posts/\" + path)\r\n      setPost(res.data)\r\n      setTitle(res.data.title)\r\n      setDesc(res.data.desc)\r\n    };\r\n    getPost()\r\n  },[path])\r\n\r\n  const handleDelete = async() => {\r\n    try {\r\n      await axios.delete(`/posts/${post._id}`, {\r\n      data: { username: user.username },});\r\n      window.location.replace(\"/\");\r\n    } catch (err) {\r\n\r\n    }\r\n  };\r\n\r\n  const handleUpdate = async () => {\r\n    try {\r\n      await axios.put(`/posts/${post._id}`, {\r\n       username: user.username,\r\n       title:title,\r\n       desc,\r\n      });\r\n      //IF WANT TO RELOAD PAGE\r\n      // window.location.reload();\r\n      setUpdateMode(false)\r\n    } catch (err) {\r\n\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"singlePost\">\r\n        <div className=\"singlePostWrapper\">\r\n          {post.photo && (\r\n            <img src={PF + post.photo} alt=\"\" className=\"singlePostImg\" />\r\n          )}\r\n          \r\n            {updateMode ? (<input type=\"text\" value={title} className=\"singlePostTitleInput\" autoFocus onChange={(e)=>setTitle(e.target.value)}/>) : (\r\n              \r\n           \r\n            <h1 className=\"singlePostTitle\">\r\n              {title}\r\n              {post.username === user?.username && (\r\n            <div className=\"singlePostEdit\">\r\n            <i className=\"singlePostIcon fa-regular fa-pen-to-square\" onClick={() => setUpdateMode(true)}></i>\r\n            <i class=\"singlePostIcon fa-solid fa-trash\" onClick={handleDelete}></i>\r\n            </div>\r\n)}\r\n            </h1>\r\n             )\r\n            }\r\n            <div className=\"singlePostInfo\">\r\n                <span className=\"singlePostAuthor\">Author: \r\n                <Link to={`/?user=${post.username}`} className=\"link\">\r\n                  <b>{post.username}</b>\r\n                  </Link>\r\n                </span>\r\n                <span className=\"singlePostDate\">{new Date(post.createdAt).toDateString()}</span>\r\n            </div>\r\n            {updateMode ? (<textarea className=\"singlePostDescInput\" value={desc} onChange={(e)=>setDesc(e.target.value)}/>) : \r\n            (<p className=\"singlePostDesc\">\r\n              {desc}\r\n            </p>)}\r\n            {updateMode && (\r\n            <button className=\"singlePostButton\" onClick={handleUpdate}>Update</button>\r\n            )}\r\n        </div>\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}